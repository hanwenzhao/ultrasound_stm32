// Reference: https://github.com/54zorb/stm32-lwip/tree/master/Src

#include "ethernet_comm.h"
#include "stm32f7xx_hal.h"
#include "lwip.h"
#include "lwip/netif.h"

void ethernet_sendtest1(void)
{
    uint8_t frame_data[] =
    {
        /* 以太网帧格式 */
        0xA0,0xCE,0xC8,0xCD,0xB0,0xD4,                            /* 远端MAC */
        0x0,0x80,0xE1,0x0,0x0,0x0,                                /* 本地MAC */
        0x8,0x0,                                                  /* ip类型 */
        0x45,0x0,0x0,0x26/*l*/,0x0,0x0,0x0,0x0,0xFF,0x11,0x0,0x0, /* UDP报头 */
        0xA9,0xFE,0xD4,0xB4,                                        /* 本地IP */
        0xA9,0xFE,0xD4,0xBB,                                       /* 远端IP */
        0x22,0xB0,                                                /* 本地端口 */
        0x22,0xB1,                                                /* 远端端口 */
        0x1,0xf4,                                                 /* UDP长度 */
        0x0,0x0,                                                  /* UDP校验和 */
        0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,         /* 数据 */
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,         /* 数据 */
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
				0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,         /* 数据 */
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
						0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,         /* 数据 */
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
								0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,         /* 数据 */
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
										0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,


    };

    struct pbuf *p;

    // create buffer
    p = pbuf_alloc(PBUF_TRANSPORT, 0x26 + 14, PBUF_POOL);

    if (p != NULL)
    {
        // fill buffer
        pbuf_take(p, frame_data, 0x26 + 14);

        // send buffer
        gnetif.linkoutput(&gnetif, p);

        // free buffer
        pbuf_free(p);
    }
}
